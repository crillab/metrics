test:
    script:
        - make test
    tags:
        - pytest
    stage: test
sonar:
    script:
        - make sonar
    tags:
        - pylint
        - sonar
    stage: test
build:
    script:
        - make docker-build
    tags:
        - docker
    stage: build
deploy_cril:
    stage: deploy
    tags:
        - docker
    script:
        - echo "$DOCKER_PASSWORD" | docker login --username "$DOCKER_USERNAME" --password-stdin -p 
        - docker push thibaultfalque/metrics:latest
    needs: ["build"]
    environment:
        name: CRIL_ENV
    only:
        - web